<header class="header">
  <div class="header-container">
    <div class="logo">
      <a [routerLink]="shopBaseUrl">
        <span class="shop-name">{{ shop?.title || 'FurnitureStore' }}</span>
      </a>
    </div>

    <nav class="nav-desktop">
      <a [routerLink]="shopBaseUrl" class="nav-link">Home</a>
      <a [routerLink]="shopBaseUrl + '/store'" class="nav-link">Store</a>
      <a [routerLink]="shopBaseUrl + '/room-planner'" class="nav-link">Room Planner</a>
    </nav>

    <div class="header-actions">
      <!-- Cart icon -->
      <a [routerLink]="shopBaseUrl + '/cart'" class="cart-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="9" cy="21" r="1"></circle>
          <circle cx="20" cy="21" r="1"></circle>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
        <span class="cart-count" *ngIf="cartCount > 0">{{ cartCount }}</span>
      </a>

      <!-- Login button or User menu -->
      @if (currentUser) {
        <div class="user-menu-container">
          <button class="user-menu-button" (click)="toggleUserMenu()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span class="user-name">{{ (currentUser.fullName || currentUser.email || 'User').split(' ')[0] }}</span>
          </button>
          @if (showUserMenu) {
            <div class="user-dropdown">
              <div class="user-info">
                <p class="user-full-name">{{ currentUser.fullName || currentUser.email || 'User' }}</p>
                <p class="user-email">{{ currentUser.email }}</p>
              </div>
              <button class="logout-button" (click)="logout()">Logout</button>
            </div>
          }
        </div>
      } @else {
        <button class="login-button" (click)="openLoginModal()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          <span class="login-text">Login</span>
        </button>
      }
    </div>

    <button class="burger-menu" (click)="toggleMobileMenu()" [class.active]="isMobileMenuOpen">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>

  <nav class="nav-mobile" [class.active]="isMobileMenuOpen">
    <a [routerLink]="shopBaseUrl" class="nav-link" (click)="closeMobileMenu()">Home</a>
    <a [routerLink]="shopBaseUrl + '/store'" class="nav-link" (click)="closeMobileMenu()">Store</a>
    <a [routerLink]="shopBaseUrl + '/room-planner'" class="nav-link" (click)="closeMobileMenu()">Room Planner</a>
  </nav>

  <!-- Auth Modals -->
  @if (showLoginModal) {
    <app-login-modal 
      (close)="closeLoginModal()" 
      (switchToRegisterModal)="switchToRegister()">
    </app-login-modal>
  }
  
  @if (showRegisterModal) {
    <app-register-modal 
      (close)="closeRegisterModal()" 
      (switchToLoginModal)="switchToLogin()">
    </app-register-modal>
  }
</header>
